\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{matlabstyle}

\RequirePackage{verbatim}
\RequirePackage{fancyvrb}
\RequirePackage{alltt}
\RequirePackage{upquote}
\RequirePackage[framemethod=tikz]{mdframed}
\RequirePackage{color}


\newcommand{\maxwidth}[1]{\ifdim\linewidth>#1 #1\else\linewidth\fi}
\newcommand{\mlcell}[1]{{\color{output}\verbatim@font#1}}

\definecolor{output}{gray}{0.4}

% Conversione caratteri UNICODE di utilitÃ 
\DeclareUnicodeCharacter{B0}{\ensuremath{^\circ}}
\DeclareUnicodeCharacter{21B5}{\ensuremath{\hookleftarrow}}

% Indentazione dei paragrafi
\setlength{\parindent}{0pt}

% Stili per gli ambienti matlabcode e matlaboutput
\mdfdefinestyle{matlabcode}{
  outerlinewidth=.5pt,
  linecolor=gray!20!white,
  roundcorner=2pt,
  innerleftmargin=1em,
  backgroundcolor=gray!10!white,
  skipabove=1.5em,                 
  skipbelow=0,                  
}

\mdfdefinestyle{matlaboutputstyle}{
    hidealllines=true,          
    backgroundcolor=white,      
    innerleftmargin=1.25em,       
    roundcorner=2pt,
    skipabove=10pt,                 
    skipbelow=0,                 
}

\newenvironment{matlabcode}{\Verbatim}{\endVerbatim}
\surroundwithmdframed[style=matlabcode]{matlabcode}

\newenvironment{matlaboutput}{\Verbatim[xleftmargin=1.25em, formatcom=\color{output}]}{\endVerbatim}

\newenvironment{matlabsymbolicoutput}{
  \list{}{\leftmargin=1.25em\relax}
  \item\relax
  \color{output}\verbatim@font
}{\endlist}

\newenvironment{matlabtableoutput}[1]{
  {\color{output}
  \hspace*{1.25em}#1}
}{}

\renewenvironment{matlaboutput}{\Verbatim[formatcom=\color{output}]}{\endVerbatim}
\surroundwithmdframed[style=matlaboutputstyle]{matlaboutput}

% Table of Contents style
\newcounter{multititle}
\newcommand{\matlabmultipletitles}{\setcounter{multititle}{1}}

\newcounter{hastoc}
\newcommand{\matlabhastoc}{\setcounter{hastoc}{1}}

\newcommand{\matlabtitle}[1]{
\ifnum\value{multititle}>0
}